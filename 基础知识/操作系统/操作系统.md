## 操作系统基本概念

### 定义

操作系统是计算机系统中的一个系统软件，是一些程序模块的集合。

### 作用

* 资源的管理者
  * 跟踪记录资源的使用状况
  * 确定资源分配策略
    * 静态分配策略
    * **动态分配策略**
  * 实施资源的分配和回收
  * 提高资源利用率
  * 保护资源的使用
  * 协调多个进程对资源请求的冲突
* 向用户提供各种服务
* 对硬件机器的扩展

### 功能（从资源管理角度）

* 进程/线程管理（CPU管理）：进程线程状态、控制、同步互斥、通信、调度等
* 存储管理：分配/回收、地址转换、存储保护、内存扩充等
* 文件管理：文件目录、文件操作、磁盘空间、文件存取控制等
* 设备管理：设备驱动、分配回收、缓冲技术等
* 用户接口：系统命令、编程接口等

### 特征

#### 并发（concurrency）

处理多个同时性活动的能力。单CPU上宏观上这些程序同时在执行。微观上任何时刻只有一个程序真正在执行，即这些程序在CPU上是轮流执行的。并行（parallel）多指不同程序同时在多个硬件部件上执行。

#### 共享（sharing）

操作系统与多个用户的程序共同使用计算机系统中的资源（共享有限的系统资源）。包括互斥共享和同时共享

#### 虚拟（Virtual）

一个物理实体映射为若干个对应的逻辑实体--分时或分空间，提高资源利用率。

#### 随机

操作系统必须随时对以不可预测的次序发生的事件进行响应并处理。

## 操作系统运行环境和运行机制

### 运行环境

#### CPU状态

处理器由运算器、控制器、一系列的寄存器以及高速缓存构成。

##### 控制和状态寄存器

用于控制处理器的操作，在某种特权级别下可以访问、修改

常见的控制和状态寄存器

* 程序计数器（PC:Program Counter），记录将要取出的指令的地址
* 指令寄存器（IR:Instruction Register）,记录最近取出的指令
* 程序状态字（PSW:Program status Word），记录处理器的运行状态如条件码、模式、控制位等信息

操作系统需要两种CPU状态

* **内核态**（Kernel Mode）：运行操作系统程序
* **用户态**（User Mode）：运行用户程序

特权指令：只能由操作系统使用、用户程序不能使用的指令。包括启动I/O、内存清零、修改程序状态字、设置时钟、允许/禁止中断、停机等

非特权指令：用户程序可以使用的指令。包括控制转移、算数运算、访管指令、取数指令等

##### CPU状态转换

用户态 -> 内核态：唯一途径中断/异常/陷入机制

内核态 -> 用户态：设置程序状态字PSW

#### 中断/异常机制

### 运行机制

#### 系统调用

